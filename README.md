# Agent AIGC - å…¨æ¨¡æ€ AI åˆ›ä½œå¹³å°

> åŸºäºæ™ºèƒ½è·¯ç”± Agent æ¶æ„çš„å…¨æ¨¡æ€ AI å†…å®¹åˆ›ä½œå¹³å°ï¼Œå¯¹æ¥ Google Gemini / Veo / TTS ç­‰æ¨¡å‹ï¼Œæ”¯æŒæ–‡ç”Ÿå›¾ã€å›¾ç”Ÿå›¾ã€æ–‡ç”Ÿè§†é¢‘ã€å›¾ç”Ÿè§†é¢‘ã€è¯­éŸ³åˆæˆç­‰èƒ½åŠ›ã€‚

## åŠŸèƒ½æ¸…å•

| åŠŸèƒ½ | æ¨¡å‹ | çŠ¶æ€ | è¯´æ˜ |
|------|------|------|------|
| ğŸ–¼ï¸ æ–‡ç”Ÿå›¾ | Google Gemini (Nano Banana) | âœ… | æ”¯æŒå¤šç§é£æ ¼å’Œå®½é«˜æ¯”ï¼Œæœ€é«˜ 4K |
| ğŸ¨ å›¾ç”Ÿå›¾ | Google Gemini (Nano Banana) | âœ… | åŸºäºå‚è€ƒå›¾ç‰‡ç”Ÿæˆæ–°å›¾ç‰‡/é£æ ¼è¿ç§» |
| ğŸ¬ æ–‡ç”Ÿè§†é¢‘ | Google Veo 3.1 | âœ… | æ”¯æŒ 4-8 ç§’è§†é¢‘ï¼Œå«éŸ³é¢‘ |
| ğŸ“¹ å›¾ç”Ÿè§†é¢‘ | Google Veo 3.1 | âœ… | å°†é™æ€å›¾ç‰‡å˜æˆåŠ¨æ€è§†é¢‘ |
| ğŸ¤ è¯­éŸ³åˆæˆ | Google Gemini TTS | âœ… | å¤šç§è¯­éŸ³é£æ ¼ï¼Œè‡ªç„¶æµç•… |
| ğŸ¯ æ™ºèƒ½è·¯ç”± | OneRouter (gpt-4o-mini) | âœ… | è‡ªåŠ¨æ„å›¾åˆ†æ + æ¨¡å‹é€‰æ‹© + æç¤ºè¯ä¼˜åŒ– |
| ğŸ–¼ï¸ çµæ„Ÿå¹¿åœº | - | âœ… | æç¤ºè¯åº“æµè§ˆã€å¤åˆ¶ã€ä¸€é”®ä½¿ç”¨ |
| ğŸ“‚ æˆ‘çš„èµ„äº§ | - | âœ… | ç”Ÿæˆä½œå“ç®¡ç†ã€ä¸‹è½½ã€åˆ†äº«åˆ°å¹¿åœº |

## æŠ€æœ¯æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          å‰ç«¯ (Vue 3)                            â”‚
â”‚  åˆ›ä½œå·¥ä½œå° â”‚ çµæ„Ÿå¹¿åœº â”‚ æˆ‘çš„èµ„äº§                                    â”‚
â”‚  Element Plus + Tailwind CSS + Vite                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚ REST API
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       åç«¯ (Spring Boot 3)                       â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚              1ï¸âƒ£ æ™ºèƒ½è·¯ç”± Agent (æ ¸å¿ƒ)                       â”‚   â”‚
â”‚  â”‚  IntentAnalyzer â†’ RoutingAgent â†’ PromptEnhancer          â”‚   â”‚
â”‚  â”‚       â†‘ ä½¿ç”¨ OneRouter gpt-4o-mini (ä½æˆæœ¬è·¯ç”±å†³ç­–)         â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                              â†“                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚              2ï¸âƒ£ å†…å®¹ç”Ÿæˆ Providers                         â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚   â”‚
â”‚  â”‚  â”‚  IMAGE   â”‚  â”‚  VIDEO   â”‚  â”‚  AUDIO   â”‚               â”‚   â”‚
â”‚  â”‚  â”‚ (Gemini) â”‚  â”‚  (Veo)   â”‚  â”‚  (TTS)   â”‚               â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                  â”‚
â”‚  MySQL + Redis + JPA                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ ¸å¿ƒè®¾è®¡ç†å¿µ

**ç”¨æˆ·åªéœ€æè¿°éœ€æ±‚ï¼Œç³»ç»Ÿè‡ªåŠ¨å¤„ç†ä¸€åˆ‡ï¼š**
1. **æ„å›¾ç†è§£** - Agent ä½¿ç”¨ LLM è§£æè‡ªç„¶è¯­è¨€ï¼Œæå–æŠ€æœ¯å‚æ•°ï¼ˆå†…å®¹ç±»å‹ã€åˆ†è¾¨ç‡ã€æ—¶é•¿ç­‰ï¼‰
2. **æ¨¡å‹é€‰æ‹©** - æ ¹æ®å†…å®¹ç±»å‹å’Œè´¨é‡è¦æ±‚è‡ªåŠ¨é€‰æ‹©æœ€ä¼˜æ¨¡å‹
3. **æç¤ºè¯ä¼˜åŒ–** - è‡ªåŠ¨å¢å¼ºæç¤ºè¯è´¨é‡ï¼Œæé«˜ç”Ÿæˆæ•ˆæœ
4. **å¼‚æ­¥æ‰§è¡Œ** - ä»»åŠ¡æäº¤åå¼‚æ­¥ç”Ÿæˆï¼Œå‰ç«¯è½®è¯¢è·å–è¿›åº¦

## æŠ€æœ¯æ ˆ

### åç«¯
| æŠ€æœ¯ | ç‰ˆæœ¬ | è¯´æ˜ |
|------|------|------|
| Spring Boot | 3.4.5 | åŸºç¡€æ¡†æ¶ |
| Java | 17 | ç¼–ç¨‹è¯­è¨€ |
| Spring Data JPA | - | ORM æŒä¹…å±‚ |
| MySQL | 8.x | å…³ç³»æ•°æ®åº“ |
| Redis | - | ç¼“å­˜ |
| OkHttp | - | HTTP å®¢æˆ·ç«¯ï¼ˆè°ƒç”¨ AI APIï¼‰ |
| Druid | - | æ•°æ®åº“è¿æ¥æ±  |

### å‰ç«¯
| æŠ€æœ¯ | ç‰ˆæœ¬ | è¯´æ˜ |
|------|------|------|
| Vue | 3.5 | å‰ç«¯æ¡†æ¶ |
| TypeScript | 5.6 | ç±»å‹å®‰å…¨ |
| Vite | 7.x | æ„å»ºå·¥å…· |
| Element Plus | 2.11 | UI ç»„ä»¶åº“ |
| Tailwind CSS | 4.x | æ ·å¼æ¡†æ¶ |
| Pinia | 3.x | çŠ¶æ€ç®¡ç† |
| Vue Router | 4.x | è·¯ç”±ç®¡ç† |

### AI æ¨¡å‹
| æ¨¡å‹ | æä¾›å•† | ç”¨é€” | ä»·æ ¼å‚è€ƒ |
|------|--------|------|---------|
| gemini-2.5-flash-image | Google | å›¾ç‰‡ç”Ÿæˆ | $0.039/å¼  |
| gemini-3-pro-image-preview | Google | é«˜è´¨é‡å›¾ç‰‡ | $0.134-0.24/å¼  |
| veo-3.1-fast-generate-preview | Google | å¿«é€Ÿè§†é¢‘ç”Ÿæˆ | $0.15/ç§’ |
| veo-3.1-generate-preview | Google | é«˜è´¨é‡è§†é¢‘ | $0.40/ç§’ |
| gemini-2.5-flash-preview-tts | Google | è¯­éŸ³åˆæˆ | æŒ‰ token è®¡è´¹ |
| gpt-4o-mini (via OneRouter) | OpenAI | Agent è·¯ç”±å†³ç­– | $0.15/$0.60 per 1M tokens |

## å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- Java 17+
- Node.js 20+ï¼ˆæ¨è pnpmï¼‰
- MySQL 8.x
- Redis

### 1. å…‹éš†é¡¹ç›®

```bash
cd agent-aigc
```

### 2. æ•°æ®åº“åˆå§‹åŒ–

```sql
CREATE DATABASE agent_aigc DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
```

> è¡¨ç»“æ„ä¼šç”± JPA è‡ªåŠ¨åˆ›å»ºï¼ˆ`ddl-auto: update`ï¼‰

### 3. é…ç½® API Key

```bash
# å¤åˆ¶é…ç½®æ¨¡æ¿
cp backend/src/main/resources/application-local.yml.example \
   backend/src/main/resources/application-local.yml

# ç¼–è¾‘é…ç½®æ–‡ä»¶ï¼Œå¡«å…¥ä½ çš„ API Key
# - Google API Key: https://aistudio.google.com/apikey
# - OneRouter API Key: https://onerouter.pro
```

é…ç½®æ–‡ä»¶ä¸­éœ€è¦å¡«å†™çš„å…³é”®é¡¹ï¼š

```yaml
aigc:
  providers:
    google:
      api-key: <your_google_api_key>      # Google GenAI API Key
      # proxy-host: 127.0.0.1             # å¦‚éœ€ä»£ç†è®¿é—® Google API
      # proxy-port: 7897
    onerouter:
      api-key: <your_onerouter_api_key>    # OneRouter API Key
```

ä¹Ÿå¯ä»¥é€šè¿‡ç¯å¢ƒå˜é‡é…ç½®ï¼š

```bash
export GOOGLE_API_KEY=your_google_api_key
export ONEROUTER_API_KEY=your_onerouter_api_key
```

### 4. å¯åŠ¨åç«¯

```bash
cd backend
mvn spring-boot:run
# é»˜è®¤ç«¯å£ï¼š10003
```

### 5. å¯åŠ¨å‰ç«¯

```bash
cd frontend
pnpm install
pnpm dev
# é»˜è®¤ç«¯å£ï¼š5173ï¼Œè‡ªåŠ¨æ‰“å¼€æµè§ˆå™¨
```

### 6. è®¿é—®

- å‰ç«¯ç•Œé¢ï¼šhttp://localhost:5173
- åç«¯ APIï¼šhttp://localhost:10003
- Druid ç›‘æ§ï¼šhttp://localhost:10003/druidï¼ˆadmin / admin123ï¼‰

## API æ¥å£

| æ–¹æ³• | è·¯å¾„ | è¯´æ˜ |
|------|------|------|
| POST | `/api/aigc/generate` | æ™ºèƒ½ç”Ÿæˆï¼ˆAgent æ ¸å¿ƒå…¥å£ï¼‰ |
| GET | `/api/aigc/task/{taskId}` | æŸ¥è¯¢ä»»åŠ¡çŠ¶æ€ |
| GET | `/api/aigc/models` | è·å–å¯ç”¨æ¨¡å‹åˆ—è¡¨ |
| GET | `/api/aigc/gallery` | çµæ„Ÿå¹¿åœºä½œå“åˆ—è¡¨ |
| POST | `/api/aigc/gallery/save` | ä¿å­˜ä½œå“åˆ°å¹¿åœº |
| GET | `/api/aigc/assets` | æˆ‘çš„èµ„äº§åˆ—è¡¨ |
| DELETE | `/api/aigc/assets/{assetId}` | åˆ é™¤èµ„äº§ |

### ç”Ÿæˆæ¥å£ç¤ºä¾‹

```bash
# æ–‡ç”Ÿå›¾
curl -X POST http://localhost:10003/api/aigc/generate \
  -H "Content-Type: application/json" \
  -d '{"prompt": "ä¸€åªå¯çˆ±çš„æ©˜çŒ«åœ¨é˜³å…‰ä¸‹æ‰“ç›¹"}'

# å›¾ç”Ÿå›¾ï¼ˆé™„å¸¦å‚è€ƒå›¾ç‰‡ï¼‰
curl -X POST http://localhost:10003/api/aigc/generate \
  -H "Content-Type: application/json" \
  -d '{"prompt": "æŠŠè¿™å¼ ç…§ç‰‡å˜æˆæ°´å½©ç”»é£æ ¼", "referenceImages": ["data:image/jpeg;base64,..."]}'

# æ–‡ç”Ÿè§†é¢‘
curl -X POST http://localhost:10003/api/aigc/generate \
  -H "Content-Type: application/json" \
  -d '{"prompt": "æ¨±èŠ±éšé£é£˜è½çš„çŸ­è§†é¢‘"}'

# å›¾ç”Ÿè§†é¢‘
curl -X POST http://localhost:10003/api/aigc/generate \
  -H "Content-Type: application/json" \
  -d '{"prompt": "è®©è¿™å¼ å›¾ç‰‡åŠ¨èµ·æ¥", "referenceImages": ["data:image/jpeg;base64,..."]}'

# è¯­éŸ³åˆæˆ
curl -X POST http://localhost:10003/api/aigc/generate \
  -H "Content-Type: application/json" \
  -d '{"prompt": "è¯·æœ—è¯»ä»¥ä¸‹å†…å®¹ï¼šå¤§å®¶å¥½ï¼Œæ¬¢è¿æ¥åˆ°AIåˆ›ä½œå¹³å°"}'

# æŸ¥è¯¢ä»»åŠ¡çŠ¶æ€
curl http://localhost:10003/api/aigc/task/{taskId}
```

## é¡¹ç›®ç»“æ„

```
agent-aigc/
â”œâ”€â”€ backend/                          # åç«¯ Spring Boot
â”‚   â”œâ”€â”€ src/main/java/com/anjing/
â”‚   â”‚   â”œâ”€â”€ aigc/
â”‚   â”‚   â”‚   â”œâ”€â”€ agent/                # æ™ºèƒ½è·¯ç”± Agent
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ RoutingAgent.java       # æ ¸å¿ƒè·¯ç”± Agent
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ IntentAnalyzer.java     # æ„å›¾åˆ†æå™¨
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ PromptEnhancer.java     # æç¤ºè¯å¢å¼ºå™¨
â”‚   â”‚   â”‚   â”œâ”€â”€ provider/             # å†…å®¹ç”Ÿæˆæä¾›å•†
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ google/
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ GoogleImageProvider.java  # Gemini å›¾ç‰‡ç”Ÿæˆ
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ GoogleVideoProvider.java  # Veo è§†é¢‘ç”Ÿæˆ
â”‚   â”‚   â”‚   â”‚   â”‚   â””â”€â”€ GoogleAudioProvider.java  # TTS éŸ³é¢‘ç”Ÿæˆ
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ ProviderRouter.java           # æä¾›å•†è·¯ç”±
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ ContentProvider.java          # æä¾›å•†åŸºç±»
â”‚   â”‚   â”‚   â”œâ”€â”€ controller/           # REST æ§åˆ¶å™¨
â”‚   â”‚   â”‚   â”œâ”€â”€ service/              # ä¸šåŠ¡æœåŠ¡
â”‚   â”‚   â”‚   â”œâ”€â”€ model/                # æ•°æ®æ¨¡å‹ï¼ˆDTO/Entity/Enumï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ repository/           # æ•°æ®ä»“å‚¨
â”‚   â”‚   â”‚   â””â”€â”€ config/               # AIGC é…ç½®
â”‚   â”‚   â””â”€â”€ ...                       # é€šç”¨æ¨¡å—ï¼ˆå¼‚å¸¸ã€åˆ‡é¢ã€å·¥å…·ç­‰ï¼‰
â”‚   â””â”€â”€ src/main/resources/
â”‚       â”œâ”€â”€ application.yml                  # ä¸»é…ç½®
â”‚       â”œâ”€â”€ application-local.yml.example    # æœ¬åœ°é…ç½®æ¨¡æ¿
â”‚       â””â”€â”€ logback-spring.xml               # æ—¥å¿—é…ç½®
â”‚
â”œâ”€â”€ frontend/                         # å‰ç«¯ Vue 3
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ views/aigc/
â”‚   â”‚   â”‚   â”œâ”€â”€ studio/               # åˆ›ä½œå·¥ä½œå°
â”‚   â”‚   â”‚   â”œâ”€â”€ gallery/              # çµæ„Ÿå¹¿åœº
â”‚   â”‚   â”‚   â””â”€â”€ assets/               # æˆ‘çš„èµ„äº§
â”‚   â”‚   â”œâ”€â”€ api/aigc.ts               # AIGC API æ¥å£
â”‚   â”‚   â””â”€â”€ router/modules/aigc.ts    # AIGC è·¯ç”±
â”‚   â””â”€â”€ public/data/prompts.json      # é™æ€æç¤ºè¯æ•°æ®
â”‚
â”œâ”€â”€ scripts/                          # è¾…åŠ©è„šæœ¬
â”‚   â””â”€â”€ crawl_banana_prompts.py       # æç¤ºè¯çˆ¬å–è„šæœ¬
â”‚
â”œâ”€â”€ .gitignore                        # Git å¿½ç•¥è§„åˆ™
â””â”€â”€ README.md                         # æœ¬æ–‡ä»¶
```

## è®¸å¯è¯

æœ¬é¡¹ç›®ä»…ä¾›æ•™å­¦å’Œå­¦ä¹ ä½¿ç”¨ã€‚
